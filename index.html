<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AR Business Card</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/ar.js@4.3.2/aframe/build/aframe-ar.js"></script>
<style>
  body { margin:0; overflow:hidden; background:#111; color:white; text-align:center; }
  #startButton {
    font-size: 22px; padding:15px 30px; margin-top: 30%; cursor:pointer;
    border:none; border-radius:8px; background: #0af; color:white;
  }
  .hover-glow:hover { opacity:0.8; transform:scale(1.2); transition: all 0.3s ease; }
</style>
</head>
<body>

<h2>Click to Start AR</h2>
<button id="startButton">Start AR</button>
<div id="arContainer" style="width:100%; height:100%; display:none;"></div>

<script>
document.querySelector('#startButton').addEventListener('click', () => {
  const btn = document.querySelector('#startButton');
  btn.style.display = 'none';

  const container = document.querySelector('#arContainer');
  container.style.display = 'block';

  container.innerHTML = `
    <a-scene
      embedded
      vr-mode-ui="enabled: false"
      renderer="antialias: true; alpha: true"
      arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: true; detectionMode: mono_and_matrix;">
      
      <!-- Business Card Marker -->
      <a-marker type="pattern" url="img/business-card.patt" id="businessMarker">
        <!-- Avatar -->
        <a-entity id="avatar" gltf-model="model/avatar.glb"
                  scale="0.4 0.4 0.4"
                  position="0 0 0"
                  rotation="0 180 0"
                  animation="property: rotation; to: 0 190 0; dir: alternate; dur: 2000; loop: true"
                  visible="false">
        </a-entity>

        <!-- Website Button -->
        <a-entity id="btn-website" gltf-model="model/button_website.glb"
                  scale="0.15 0.15 0.15"
                  position="-0.4 0 0"
                  rotation="0 180 0"
                  class="clickable hover-glow"
                  visible="false">
          <a-animation attribute="position" dur="2000" direction="alternate" repeat="indefinite"
                       to="-0.4 0.1 0"></a-animation>
        </a-entity>

        <!-- LinkedIn Button -->
        <a-entity id="btn-linkedin" gltf-model="model/button_linkedin.glb"
                  scale="0.15 0.15 0.15"
                  position="0.4 0 0"
                  rotation="0 180 0"
                  class="clickable hover-glow"
                  visible="false">
          <a-animation attribute="position" dur="2000" direction="alternate" repeat="indefinite"
                       to="0.4 0.1 0"></a-animation>
        </a-entity>
      </a-marker>

      <!-- Fallback Hiro Marker -->
      <a-marker preset="hiro">
        <a-box position="0 0.5 0" color="blue" scale="0.5 0.5 0.5"></a-box>
      </a-marker>

      <a-entity camera></a-entity>
    </a-scene>
  `;

  // Wait for the scene to load
  setTimeout(() => {
    const scene = document.querySelector('a-scene');
    const avatar = document.querySelector('#avatar');
    const websiteBtn = document.querySelector('#btn-website');
    const linkedinBtn = document.querySelector('#btn-linkedin');
    const marker = document.querySelector('#businessMarker');

    // Show avatar & buttons when marker is detected
    marker.addEventListener('markerFound', () => {
      avatar.setAttribute('visible', 'true');
      websiteBtn.setAttribute('visible', 'true');
      linkedinBtn.setAttribute('visible', 'true');

      // Optionally hide debug UI after detection
      scene.components['arjs'].arToolkitContext.arController.debugUIRoot && 
      (scene.components['arjs'].arToolkitContext.arController.debugUIRoot.style.display = 'none');
    });

    // Hide avatar & buttons when marker is lost
    marker.addEventListener('markerLost', () => {
      avatar.setAttribute('visible', 'false');
      websiteBtn.setAttribute('visible', 'false');
      linkedinBtn.setAttribute('visible', 'false');

      // Show debug UI again
      scene.components['arjs'].arToolkitContext.arController.debugUIRoot &&
      (scene.components['arjs'].arToolkitContext.arController.debugUIRoot.style.display = 'block');
    });

    // Button click events
    websiteBtn.addEventListener('click', () => window.open('https://yourwebsite.com', '_blank'));
    linkedinBtn.addEventListener('click', () => window.open('https://linkedin.com/in/yourprofile', '_blank'));

    // Rotate buttons continuously
    const rotateButton = (el) => {
      let angle = 0;
      setInterval(() => {
        angle += 1;
        el.setAttribute('rotation', `0 ${180 + angle} 0`);
      }, 50);
    };
    rotateButton(websiteBtn);
    rotateButton(linkedinBtn);

  }, 1000);

});
</script>
</body>
</html>
